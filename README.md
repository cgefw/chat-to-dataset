本程序用于将聊天记录转换为带“思维链”的微调数据。

保留语境：合成连续未打断的对话，不随意丢弃他人发言。

注入思考：让 AI 回顾历史对话，反推自己当时为什么那么回答（生成 <think> 标签）。

修正逻辑：解决传统方法因切片太碎导致模型“学不到前因后果”的问题。

使用方法，下载chat_to_dataset.py，填入apikey（推荐使用deepseek-reasoner，价格便宜一些）

将qq或微信等其他社交媒体记录转换为sample_chat.txt格式的数据，将路径填入API_KEY = ""

你可以将你的导出的聊天记录截取一部分，将你的聊天记录和sample_chat.txt都上传到LLM中，比如Gemini3pro（推荐），并给出以下提示词：

”“
# Role
你是一位精通 Python 文本处理和正则表达式的数据工程师。

# Context
我正在准备一份用于大模型微调的对话数据集。我有两个文件：
1. `你的文件`: 这是我从社交软件（如QQ或微信）导出的原始聊天记录片段。
2. `sample_chat.txt`: 这是我的目标格式文件，展示了数据最终应该长什么样。

# Task
请编写一个 Python 脚本，将我的 `raw_chat_log.txt` 格式转换为与 `sample_chat.txt` 完全一致的格式。

# Requirements
1. **分析结构**：首先分析 `sample_chat.txt` 的每一行结构（例如：是否包含时间戳？分隔符是什么？说话人名字怎么放？）。
2. **正则匹配**：分析 `raw_chat_log.txt` 的模式，编写正则表达式来提取“时间”、“发送者”和“消息内容”。
   - 注意：原始记录中，一条消息可能分多行发送，请确保脚本能正确合并同一条消息的内容，或者正确处理多行文本，不要丢失换行符之后的文字。
3. **清洗数据**：
   - 去除系统消息（例如“撤回了一条消息”、“加入群聊”，“图片”，“表情”等噪音）。
   - 去除无关的元数据（如果目标格式不需要时间戳，请去掉）。
4. **逻辑保留**：严格保留对话的时间顺序，不要随意丢弃任何一方的发言（除非是纯噪音）。
5. **输出代码**：请直接提供完整的、可运行的 Python 代码。代码中应包含输入文件路径和输出文件路径的变量定义。

# Example Analysis (请根据我上传的文件进行实际分析)
- 请确保转换后严格遵守目标格式。

请查看我上传的文件，并给出转换脚本。
“”

运行程序即可生成ShareGPT格式的数据集
